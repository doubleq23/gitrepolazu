import boto3

def getinstance(ipadd):
    aws_profile = 'prodcloud'
    aws_region = 'us-east-1'

    session = boto3.Session(profile_name=aws_profile)
    ec2_client = session.client('ec2', aws_region)

    #print('instance')

    describe = ec2_client.describe_instances(
        Filters=[
            {
                'Name':'instance-state-name',
                'Values':['running']
            },
            {
                'Name':'private-ip-address',
                'Values':[ipadd]
            }
        ]
    )

    for x in describe['Reservations']:
        #print(x['Instances'][0]['PrivateIpAddress'])
        instance_ID = x['Instances'][0]['InstanceId']

        tags = ec2_client.describe_tags(
            Filters=[
                {
                    'Name': 'resource-id',
                    'Values': [instance_ID]
                }
            ]
        )

        pkg_name = ''
        owner = ''
        #print(tags['Tags'][0])
        for y in tags['Tags']:
            if(y['Key']=="PackageName"):
                pkg_name = (y['Value']) # + ' ' + y['ResourceId'])
            if(y['Key']=="Owner"):
                owner = (y['Value']) # + ' ' + y['ResourceId'])
                
        print(instance_ID + ' | ipaddress : ' + ipadd + ' | owner : ' + owner + ' | package name : '+ pkg_name)
            

#############
#ip_address = ['10.15.3.110', '10.15.3.188', '10.15.3.216', '10.15.3.241', '10.15.3.25', '10.15.3.32', '10.15.3.39', '10.15.4.119', '10.15.4.156', '10.15.4.173', '10.15.4.215', '10.15.4.62', '10.15.4.79', '10.15.4.85', '10.15.4.92', '10.15.48.46', '10.15.49.22', '10.15.5.100', '10.15.5.108', '10.15.5.117', '10.15.5.119', '10.15.5.120', '10.15.5.125', '10.15.5.134', '10.15.5.154', '10.15.5.157', '10.15.5.159', '10.15.5.161', '10.15.5.164', '10.15.5.170', '10.15.5.194', '10.15.5.208', '10.15.5.215', '10.15.5.216', '10.15.5.224', '10.15.5.228', '10.15.5.234', '10.15.5.235', '10.15.5.240', '10.15.5.242', '10.15.5.251', '10.15.5.32', '10.15.5.4', '10.15.5.40', '10.15.5.45', '10.15.5.5', '10.15.5.54', '10.15.5.6', '10.15.5.60', '10.15.5.62', '10.15.5.63', '10.15.5.65', '10.15.5.66', '10.15.5.67', '10.15.5.7', '10.15.5.70', '10.15.5.76', '10.15.5.8', '10.15.5.83', '10.15.5.84', '10.15.5.85', '10.15.5.88', '10.15.5.89', '10.15.5.9', '10.15.5.92', '10.15.5.94', '10.15.50.10', '10.15.50.26', '10.15.51.213', '10.15.51.91', '10.15.52.160', '10.15.52.66', '10.15.53.222', '10.15.54.150', '10.15.54.19', '10.15.54.34', '10.15.55.113', '10.15.55.173', '10.15.55.227', '10.15.56.135', '10.15.56.38', '10.15.56.45', '10.15.57.122', '10.15.57.153', '10.15.58.220', '10.15.59.132', '10.15.59.156', '10.15.59.173', '10.15.59.240', '10.15.59.31', '10.15.6.103', '10.15.6.111', '10.15.6.112', '10.15.6.115', '10.15.6.126', '10.15.6.132', '10.15.6.134', '10.15.6.138', '10.15.6.139', '10.15.6.142', '10.15.6.143', '10.15.6.145', '10.15.6.146', '10.15.6.152', '10.15.6.159', '10.15.6.166', '10.15.6.17', '10.15.6.176', '10.15.6.197', '10.15.6.201', '10.15.6.202', '10.15.6.21', '10.15.6.210', '10.15.6.213', '10.15.6.221', '10.15.6.224', '10.15.6.229', '10.15.6.233', '10.15.6.234', '10.15.6.235', '10.15.6.238', '10.15.6.24', '10.15.6.246', '10.15.6.252', '10.15.6.4', '10.15.6.55', '10.15.6.64', '10.15.6.65', '10.15.6.69', '10.15.6.70', '10.15.6.73', '10.15.6.76', '10.15.6.87', '10.15.6.9', '10.15.6.95', '10.15.6.96', '10.15.60.213', '10.15.60.3', '10.15.60.82', '10.15.60.99', '10.15.61.119', '10.15.61.225', '10.15.61.253', '10.15.61.95', '10.15.62.231', '10.15.62.57', '10.15.63.200', '10.15.64.119', '10.15.64.225', '10.15.65.110', '10.15.65.12', '10.15.65.3', '10.15.65.7', '10.15.65.87', '10.15.65.88', '10.15.66.235', '10.15.67.0', '10.15.67.152', '10.15.67.90', '10.15.68.10', '10.15.68.145', '10.15.68.188', '10.15.68.76', '10.15.69.116', '10.15.69.236', '10.15.69.247', '10.15.7.200', '10.15.71.12', '10.15.71.189', '10.15.72.223', '10.15.72.50', '10.15.72.6', '10.15.73.194', '10.15.73.241', '10.15.74.191', '10.15.74.196', '10.15.74.222', '10.15.75.132', '10.15.75.83', '10.15.77.169', '10.15.77.41', '10.15.78.224', '10.15.78.39', '10.15.78.55', '10.15.79.131', '10.15.79.164', '10.15.79.69', '10.20.90.201', '172.17.3.100', '172.17.3.233', '172.17.3.254']



#with open('ip3.txt') as my_file:
#    ipa = my_file.readlines()

#ipa = ['10.15.5.54','10.15.6.213','10.15.5.7','10.15.6.75','10.15.6.112','10.15.6.56','10.15.6.243','10.15.5.79','10.15.6.30','10.15.5.133','10.15.5.250','10.15.6.29','10.15.6.248','10.15.5.32','10.15.5.139','10.15.5.194','10.15.6.146','10.15.6.224','10.15.5.132','10.15.6.186','10.15.5.91','10.15.5.98','10.15.6.235','10.15.5.65','10.15.5.112','10.15.6.5','10.15.5.234','10.15.6.72','10.15.6.208','10.15.6.222','10.15.6.86','10.15.5.232','10.15.6.19','10.15.5.184','10.15.4.85','10.15.6.221','10.15.5.177','10.15.5.95','10.15.5.60','10.15.6.200','10.15.6.27','10.15.5.207','10.15.6.177','10.15.5.198','10.15.6.136','10.15.6.46','10.15.6.198','10.15.5.242','10.15.5.246','10.15.6.45','10.15.5.179','10.15.6.176','10.15.6.201','10.15.5.224','10.15.5.69','10.15.5.127','10.15.4.162','10.15.67.9','10.15.67.131','10.15.50.66','10.15.74.232','10.15.62.203','10.15.59.49','10.15.64.89','10.15.49.36','10.15.71.79','10.15.56.248','10.15.70.34','10.15.5.215','10.15.3.28','10.15.72.215','10.15.51.100','10.15.71.117','10.15.73.224','10.15.69.184','10.15.76.58','10.15.61.108','10.15.50.253','10.15.76.113','10.15.55.223','10.15.57.122','10.15.76.127','10.15.66.24']
#ipa = ['10.15.70.175','10.15.59.233','10.15.74.158','10.15.74.241','10.15.60.198','10.15.78.183','10.15.49.78','10.15.57.249','10.15.49.222','10.15.5.125','10.15.5.150','10.15.62.104','10.15.68.189','10.15.77.35','10.15.77.218','10.15.60.247','10.15.6.173','10.15.76.109','10.15.5.121','10.15.51.142','10.15.5.147','10.15.6.109','10.15.60.192','10.15.54.197','10.15.5.108','10.15.49.226','10.15.56.62','10.15.71.59','10.15.75.0','10.15.55.86','10.15.49.31','10.15.5.235','10.15.79.92','10.15.50.53','10.15.60.159','10.15.3.74','10.15.70.214','10.15.6.78','10.15.69.240','10.15.48.80','10.15.5.237','10.15.65.32','10.15.62.2','10.15.5.37','10.15.60.254','10.15.64.180','10.15.52.97','10.15.6.83','10.15.6.4','10.15.6.142','10.15.3.73','10.15.62.81','10.15.5.73','10.15.78.194','10.15.5.152','10.15.5.11','10.15.6.111','10.15.75.188','10.15.51.1','10.15.59.31','10.15.78.37','10.15.5.48','10.15.5.89','10.15.69.176','10.15.78.238','10.15.6.50','10.15.5.228','10.15.6.43','10.15.3.224','10.15.5.192','10.15.53.221','10.15.63.31','10.15.77.200','10.15.76.200','10.15.67.206','10.15.75.112','10.15.6.197','10.15.6.244','10.15.74.5','10.15.6.95','10.15.65.235','10.15.53.94','10.15.4.195','10.15.5.163','10.15.59.237','10.15.6.128','10.15.48.105','10.15.50.19']
ipa = ['10.15.54.155','10.15.6.213','10.15.67.233','10.15.70.162','10.15.79.154','10.15.5.6','10.15.5.54','10.15.6.18','10.15.60.143','10.15.73.200','10.15.70.38','10.15.59.184','10.15.5.53','10.15.54.148','10.15.59.252','10.15.68.224','10.15.5.31','10.15.58.116','10.20.90.201','10.15.6.159','10.15.5.134','10.15.53.126','10.15.4.107','10.15.6.249','10.15.6.13','10.15.5.49','10.15.6.35','10.15.5.39','10.15.5.210','10.15.5.144','10.15.6.36','10.15.6.179','10.15.5.117','10.15.5.77','10.15.6.11','10.15.5.130','10.15.6.234','10.15.6.88','10.15.5.45','10.15.6.70','10.15.5.208','10.15.65.126','10.15.5.42','10.15.5.116','10.15.3.104','10.15.6.149','10.15.72.87','10.15.6.231','172.17.3.254','10.15.75.65','10.15.66.242','10.15.5.225','10.15.67.112','10.15.69.36','10.15.4.140','172.17.3.100','10.15.3.16','10.15.6.52','10.15.5.159','10.15.6.134','10.15.57.225','172.17.3.233']

for ip_address in ipa:
    print (ip_address)
    getinstance(ip_address)

#############

#getinstance(ip_address)
#privateIP = [Reservations][Instances][PrivateIpAddress]